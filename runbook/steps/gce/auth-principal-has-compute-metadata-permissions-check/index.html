<!doctype html><html lang=en class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.88.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<link rel="shortcut icon" href=/favicons/favicon.ico>
<link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192>
<title>gcpdiag</title>
<meta name=description content="
title: &ldquo;gce/Auth Principal Has Compute Metadata Permissions Check&rdquo;
linkTitle: &ldquo;Auth Principal Has Compute Metadata Permissions …">
<meta property="og:title" content>
<meta property="og:description" content="title: &ldquo;gce/Auth Principal Has Compute Metadata Permissions Check&rdquo; linkTitle: &ldquo;Auth Principal Has Compute Metadata Permissions Check&rdquo; weight: 3 type: docs description: > Verifies if the authenticated user has permissions to update SSH metadata. Product: Compute Engine
Step Type: AUTOMATED STEP
Description This step checks if the user has the necessary permissions to modify SSH metadata at the project or instance level. It focuses on project-level permissions and does not consider permissions inherited from ancestor resources like folders or organizations.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://gcpdiag.dev/runbook/steps/gce/auth-principal-has-compute-metadata-permissions-check/"><meta property="og:image" content="https://gcpdiag.dev/images/website-preview.jpg"><meta property="article:section" content="runbook">
<meta property="article:modified_time" content="2024-03-26T14:14:34+00:00"><meta property="og:site_name" content="gcpdiag">
<meta itemprop=name content>
<meta itemprop=description content="title: &ldquo;gce/Auth Principal Has Compute Metadata Permissions Check&rdquo; linkTitle: &ldquo;Auth Principal Has Compute Metadata Permissions Check&rdquo; weight: 3 type: docs description: > Verifies if the authenticated user has permissions to update SSH metadata. Product: Compute Engine
Step Type: AUTOMATED STEP
Description This step checks if the user has the necessary permissions to modify SSH metadata at the project or instance level. It focuses on project-level permissions and does not consider permissions inherited from ancestor resources like folders or organizations.">
<meta itemprop=dateModified content="2024-03-26T14:14:34+00:00">
<meta itemprop=wordCount content="221"><meta itemprop=image content="https://gcpdiag.dev/images/website-preview.jpg">
<meta itemprop=keywords content><meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://gcpdiag.dev/images/website-preview.jpg">
<meta name=twitter:title content>
<meta name=twitter:description content="title: &ldquo;gce/Auth Principal Has Compute Metadata Permissions Check&rdquo; linkTitle: &ldquo;Auth Principal Has Compute Metadata Permissions Check&rdquo; weight: 3 type: docs description: > Verifies if the authenticated user has permissions to update SSH metadata. Product: Compute Engine
Step Type: AUTOMATED STEP
Description This step checks if the user has the necessary permissions to modify SSH metadata at the project or instance level. It focuses on project-level permissions and does not consider permissions inherited from ancestor resources like folders or organizations.">
<link href=/scss/main.css rel=stylesheet>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
</head>
<body class=td-page>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-light nav-shadow flex-column flex-md-row td-navbar">
<a id=gcpdiag-top class=navbar-brand href=/>
<img src=/images/stethoscope.png height=30><span class=font-weight-bold>&nbsp;gcpdiag</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/docs/><span>Documentation</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/rules/><span>Rules</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/runbook/><span class=active>Runbook</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=https://github.com/GoogleCloudPlatform/gcpdiag><span>GitHub</span></a>
</li>
</ul>
</div>
<div class="navbar-nav mx-lg-2 d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
</div>
</nav>
</header>
<div class="container-fluid td-default td-outer">
<main role=main class=td-main>
<hr>
<h2 id=verifies-if-the-authenticated-user-has-permissions-to-update-ssh-metadata>title: &ldquo;gce/Auth Principal Has Compute Metadata Permissions Check&rdquo;
linkTitle: &ldquo;Auth Principal Has Compute Metadata Permissions Check&rdquo;
weight: 3
type: docs
description: >
Verifies if the authenticated user has permissions to update SSH metadata.</h2>
<p><strong>Product</strong>: <a href=https://cloud.google.com/compute>Compute Engine</a><br>
<strong>Step Type</strong>: AUTOMATED STEP</p>
<h3 id=description>Description</h3>
<p>This step checks if the user has the necessary permissions to modify SSH metadata at
the project or instance level. It focuses on project-level permissions and does not consider
permissions inherited from ancestor resources like folders or organizations.</p>
<h3 id=failure-reason>Failure Reason</h3>
<p>The current user does not have the necessary permissions to modify metadata,
essential for managing SSH keys. Missing permissions include one of the following:
.</p>
<h3 id=failure-remediation>Failure Remediation</h3>
<p>To grant the required permissions for managing SSH keys within the VM&rsquo;s metadata, follow these guides:</p>
<ul>
<li>For project-level SSH key management, assign roles that include the
&lsquo;compute.projects.setCommonInstanceMetadata&rsquo; permission. More details can be found here:
<a href=https://cloud.google.com/compute/docs/connect/add-ssh-keys#expandable-2>https://cloud.google.com/compute/docs/connect/add-ssh-keys#expandable-2</a></li>
<li>For instance-level SSH key management, ensure roles include &lsquo;compute.instances.setMetadata&rsquo;
permission. Step-by-step instructions are available here:
<a href=https://cloud.google.com/compute/docs/connect/add-ssh-keys#expandable-3>https://cloud.google.com/compute/docs/connect/add-ssh-keys#expandable-3</a>
Adjusting these permissions will allow for the proper management of SSH keys and, by extension,
SSH access to the VM especially if using gcloud / cloud console.</li>
</ul>
<h3 id=success-reason>Success Reason</h3>
<p>{auth_user} is authorized to update instance or project metadata, including SSH keys.
This enables gcloud and cloud console to update temporary SSH access to the VM or configure
personal SSH keys if needed.</p>
</main>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/GoogleCloudPlatform/gcpdiag aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2024 Google LLC All Rights Reserved</small>
<small class=ml-1><a href=/privacy/ target=_blank rel=noopener>Privacy Policy</a></small>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.js></script>
</body>
</html>